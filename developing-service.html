<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-12-03 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20141203" />
    <meta http-equiv="Content-Language" content="en" />
    <title>AludraTest &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>AludraTest</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-12-03
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 2.7.0-SNAPSHOT
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Using AludraTest</li>
                              
      <li>
  
                          <a href="user-guide.html" title="User Guide">
          <i class="none"></i>
        User Guide</a>
            </li>
                
      <li>
  
                          <a href="actionwordlibrary.html" title="Action Word Libraries">
          <i class="none"></i>
        Action Word Libraries</a>
            </li>
                
      <li>
  
                          <a href="service-configuration.html" title="Service Configuration">
          <i class="none"></i>
        Service Configuration</a>
            </li>
                
      <li>
  
                          <a href="log4testing-user-guide.html" title="Log4Testing">
          <i class="none"></i>
        Log4Testing</a>
            </li>
                
      <li>
  
                          <a href="codechecks.html" title="Code Checks">
          <i class="none"></i>
        Code Checks</a>
            </li>
                
      <li>
  
                          <a href="aludra-pmd-rules.html" title="PMD Ruleset">
          <i class="none"></i>
        PMD Ruleset</a>
            </li>
                              <li class="nav-header">AludraTest Services</li>
                              
      <li>
  
                          <a href="fileservice.html" title="File Service">
          <i class="none"></i>
        File Service</a>
            </li>
                
      <li>
  
                          <a href="flatfileservice.html" title="FlatFile Service">
          <i class="none"></i>
        FlatFile Service</a>
            </li>
                
      <li>
  
                          <a href="separatedfileservice.html" title="SeparatedFile Service">
          <i class="none"></i>
        SeparatedFile Service</a>
            </li>
                              <li class="nav-header">Extending AludraTest</li>
                              
      <li>
  
                          <a href="aludratest-developer-guide.html" title="Developer Guide">
          <i class="none"></i>
        Developer Guide</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Develop a Service</a>
          </li>
                
      <li>
  
                          <a href="fileservice-developer-guide.html" title="FileService Developer Guide">
          <i class="none"></i>
        FileService Developer Guide</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                        
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <?xml version='1.0' encoding='utf-8' ?><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/></head><body><h2 id="Developing_an_AludraTest_service">Developing an AludraTest service</h2><p>This page describes how to implement a service to be used by test cases with the AludraTest framework.</p><p><b>This documentation is intended for developers wanting to extend AludraTest, not for clients using AludraTest.</b></p><h3 id="Service_and_Action_Interfaces">Service and Action Interfaces</h3><p>A service provides AludraTest test cases with features to access systems under test. Service invocations can be logged automatically using the <i>Log4testing</i> component.</p><p>There exists a separation of concern between a core service management class (implementing the interface <i>AludraService</i>) and three operational interfaces (implementors of the Action interfaces <i>Interaction</i>, <i>Verification</i> and <i>Condition</i>). An optional interface for error checking (ErrorChecker) may be implemented to provide information about errors.</p><p><img title="Core interfaces of an AludraTest service" alt="Core interfaces of an AludraTest service" border="0" src="./images/AludraTest_Service_Design.png"/></p><h3 id="Service_and_Action_Implementation">Service and Action Implementation</h3><p>The following steps need to be performed in order to implement a new AludraTest service called <b>HelloService</b>:</p><ul><li>Design the operations which shall be supported by this service.</li><li>Create specific interfaces of the action interfaces, e.g. <b>HelloInteraction</b>, <b>HelloVerification</b> and <b>HelloCondition</b> and assign the operations to them. If there is no adequate operation for e.g. the Condition interface, declare a child interface anyway, as spaceholder for future operations.</li><li>Create an interface <b>HelloService</b> and declare the methods <code>perform()</code>, <code>verify()</code> and <code>check()</code> to return the specific action interface type:<ul><li><b>perform(): HelloInteraction</b></li><li><b>verify(): HelloVerification</b></li><li><b>check(): HelloCondition</b></li></ul></li><li>Implement the specific Action interfaces, e.g. with the classes <b>HelloInteractionImpl</b>, <b>HelloVerificationImpl</b> and <b>HelloConditionImpl</b></li><li>Implement the specific AludraService interface e.g. with a class <b>HelloServiceImpl</b> by implementing the interface <b>HelloService</b> directly or extending the helper class <b>AbstractAludraService</b>. The class must have a public default (no-arg) constructor. If your service shall be <a href="./service-configuration.html" title="Service Configuration">configurable</a>, extend helper class <b>AbstractConfigurableAludraService</b> instead.</li></ul><p><br/></p><p><b>TODO Remove ErrorChecker from image</b> </p><p><img border="0" src="./images/AludraTest_Custom_Service_Design.png"/></p><h3 id="Exceptions">Exceptions</h3><p>When your service operations detect an error, throw one of the predefined AludraTest exceptions:</p><ul><li><b>FunctionalFailure</b> when the Component Under Test does not behave like asserted. Usually, only methods of the <b>Verification</b> object throw this exception type. Example:</li></ul><div class="source"><pre class="prettyprint">
public void assertHello() {
  String msg = componentUnderTest.retrieveMessage();
  if (!msg.equals("Hello")) {
    throw new FunctionalFailure("Retrieved message other than 'Hello'");
}
</pre></div><ul><li><b>AutomationException</b> when a problem arises which makes it unable to complete current task. Usually, methods of the <b>Perform</b> and <b>Check</b> objects thow this exception type. AutomationExceptions allow you to add the root cause of the exception (Exception chaining). Example:</li></ul><div class="source"><pre class="prettyprint">public void isHello() {
  try {
    String msg = componentUnderTest.retrieveMessage();
    return msg.equals("Hello");
  }
  catch (SomeSocketOrIOException e) {
    throw new AutomationException("Could not check message because of communication error", e);
  }
</pre></div><ul><li><b>PerformanceFailure</b> marks that the Component Under Test does not react in a certain amount of time (in most cases, configured timeouts). This can be thrown by all kinds of methods on the service objects. In most cases, internal helper methods deal with this. Example:</li></ul><div class="source"><pre class="prettyprint">private String retrieveMessage() {
  try {
    complexExternalSystem.setTimeout(getMyConfiguredTimeout());
    String message = complexExternalSystem.readNextMessage();
  }
  catch (SomeTimeoutException e) {
    throw new PerformanceFailure("Timeout when waiting for message");
  }
}

</pre></div><ul><li><b>AccessFailure</b> can be used to mark cases when external systems are not available, which renders the complete test of the component unusable. You can throw it already in the <code>initService()</code> method of the service (when extending <b>AbstractAludraService</b>), e.g.:</li></ul><div class="source"><pre class="prettyprint">public void initService() {
  try {
    complexExternalSystem = MyLibrary.connectToHelloSystem(getConfiguredAddress());
  }
  catch (SomeConnectionException e) {
    throw new AccessFailure("Cannot connect to the Hello System at " + getConfiguredAddress(), e);
  }
}
</pre></div><ul><li>All other (checked) exceptions can be wrapped in a <b>TechnicalException</b>. The AludraTest framework wraps all unchecked exceptions (e.g. <code>NullPointerException</code>) automatically in a TechnicalException. This marks an "completely unexpected exception", which could indicate an AludraTest error (e.g. in your service implementation itself).</li></ul><p>The different types of exceptions imply different outcomes of the test case, and are used by the Log4Testing component to render the output, e.g. the color coding used for single test steps.</p><h3 id="Service_Life_Cycle">Service Life Cycle</h3><p>A service is instantiated and initialized by the AludraTest framework in three steps:</p><ol><li>Creating an instance of the service class using a <b>public default constructor</b></li><li>Calling the method <b>init()</b> on the instance</li><li>The method <b>getDescription()</b> is called on the instance to retrieve a String with elementary configuration information which is logged with the test case that requested the service.</li></ol><p>After a test is finished, the AludraTest framework closes all services by calling each one's <b>close()</b> method.</p><p><br/><img title="AludraService Life Cycle" alt="AludraService Life Cycle" border="0" src="./images/AludraTest_AludraService_Lifecycle.png"/></p><h3 id="Custom_Service_Configuration">Custom Service Configuration</h3><p>Complex services often require the possibility to configure the service, in many cases it is even required to use different configurations for different tests. AludraTest has a complex Configuration Component which can be used by services just by extending <b>AbstractConfigurableAludraService</b> instead of <b>AbstractAludraService</b>. Please refer to <a href="./service-configuration.html" title="Service Configuration">Service Configuration</a> on information how you can configure your service, and refer to the Javadoc of the interface <b>Configurable</b> to learn how your service instance will receive the configuration.</p><h2 id="Accessing_the_new_service">Accessing the new service</h2><p>In order to access the service in a test run, one has to assign the service implementation to the service interface in the configuration file <code>aludraservice.properties</code>, e.g.</p><div class="source"><pre class="prettyprint">com.my.HelloService=com.my.HelloServiceImpl
</pre></div><p>Any AludraTestCase class has one method available with which it can obtain an instance of the service: <code>getService()</code>. This method expects a <b>ComponentId</b> parameter which identifies the type of service you want to obtain. <code>ComponentId</code> has no constructor, but two static factory methods:</p><ul><li>ComponentId.create(Class&lt;?> serviceClass)</li><li>ComponentId.create(Class&lt;?> serviceClass, String instanceName)</li></ul><p>The method you use influences the configuration which is used for the service, if any. For a non-configurable service, you can always use the first method. Also use the first method to identify the "global" variant of a configurable service. The service object you retrieve will use the "global" configuration for the service type.</p><p>The second method adds an <i>instance</i> identifier to the service identifier. This allows configurators to provide configuration especially for a single use case of the service type. </p><p>Please refer to <a href="./service-configuration.html" title="Service Configuration">Service Configuration</a> to learn more about the different configuration scopes and the effect of different instance identifiers.</p><p>Example for retrieving a HelloService:</p><div class="source"><pre class="prettyprint">@Test
public void myTest() {
  HelloService myServiceObj = getService(ComponentId.create(HelloService.class, 'MyTest'));
  
  // some complex operations on myServiceObj
  
  // no close required - is called automatically by AludraTest framework
}
</pre></div></body></html>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2014
                        <a href="http://www.aludratest.org/">aludratest.org</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
